# VPN Telegram Bot ‚Äî Docker Production Guide

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–º–æ–¥—É–ª—å–Ω–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [Production Checklist](#production-checklist)
- [Troubleshooting](#troubleshooting)

---

## üìñ –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Docker** –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ VPN Telegram –±–æ—Ç–∞ —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Docker Network                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ  ‚îÇ   User Bot      ‚îÇ         ‚îÇ   Admin Bot     ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  (container)    ‚îÇ         ‚îÇ  (container)    ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ         ‚îÇ                 ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Registration ‚îÇ         ‚îÇ  ‚Ä¢ Management   ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Profile      ‚îÇ         ‚îÇ  ‚Ä¢ Users        ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Subscription ‚îÇ         ‚îÇ  ‚Ä¢ Servers      ‚îÇ           ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Payment      ‚îÇ         ‚îÇ  ‚Ä¢ Monitoring   ‚îÇ           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
‚îÇ           ‚îÇ                           ‚îÇ                     ‚îÇ
‚îÇ           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îÇ
‚îÇ                       ‚îÇ                                     ‚îÇ
‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                            ‚îÇ
‚îÇ              ‚îÇ  Shared Volume  ‚îÇ                            ‚îÇ
‚îÇ              ‚îÇ   (database)    ‚îÇ                            ‚îÇ
‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ—Ä—Ç |
|-----------|----------|------|
| `vpn-user-bot` | –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ù–µ—Ç |
| `vpn-admin-bot` | –ê–¥–º–∏–Ω-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ù–µ—Ç |

---

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–ª—è Ubuntu/Linux

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker Compose (–µ—Å–ª–∏ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ Docker)
sudo apt-get install docker-compose-plugin

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER
```

### –î–ª—è Windows

1. –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Docker Desktop](https://www.docker.com/products/docker-desktop)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# Ubuntu/Linux
docker --version
docker compose version

# Windows PowerShell
docker --version
docker compose version
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd PythonProject

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –æ–∫—Ä—É–∂–µ–Ω–∏—è
# Ubuntu/Linux
cp .env.docker.example .env

# Windows PowerShell
Copy-Item .env.docker.example .env
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

```env
# Telegram Bot Tokens (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
BOT_TOKEN=your_main_bot_token_here
ADMIN_BOT_TOKEN=your_admin_bot_token_here

# Database
DATABASE_URL=sqlite+aiosqlite:///data/bot.db

# Logging
LOG_LEVEL=INFO

# Security
SECRET_KEY=generate_random_32_char_string_here
ADMIN_TELEGRAM_IDS=your_telegram_id
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# Ubuntu/Linux
chmod +x docker-scripts.sh
./docker-scripts.sh start

# Windows PowerShell
.\docker-scripts.ps1 start
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# Ubuntu/Linux
./docker-scripts.sh status

# Windows PowerShell
.\docker-scripts.ps1 status
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|------------|----------|--------------|-------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞ | - | ‚úÖ |
| `ADMIN_BOT_TOKEN` | –¢–æ–∫–µ–Ω –∞–¥–º–∏–Ω-–±–æ—Ç–∞ | - | ‚úÖ |
| `DATABASE_URL` | URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `sqlite+aiosqlite:///data/bot.db` | ‚ùå |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `INFO` | ‚ùå |
| `SECRET_KEY` | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á | - | ‚úÖ |
| `ADMIN_TELEGRAM_IDS` | Telegram ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ | - | ‚úÖ |

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –±–æ—Ç–æ–≤

1. **–û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç**: –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [@BotFather](https://t.me/BotFather)
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω

2. **–ê–¥–º–∏–Ω-–±–æ—Ç**: –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –±–æ—Ç–∞

### –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram ID

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [@userinfobot](https://t.me/userinfobot) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∞—à–µ–≥–æ Telegram ID.

---

## üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

### –°–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### Ubuntu/Linux (bash)

```bash
./docker-scripts.sh <command>
```

#### Windows (PowerShell)

```powershell
.\docker-scripts.ps1 <command>
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `start` | –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `stop` | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `restart` | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `logs [service]` | –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ |
| `status` | –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `build` | –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ |
| `clean` | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ |
| `init-db` | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î |
| `shell [service]` | –î–æ—Å—Ç—É–ø –∫ shell –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è |
| `help` | –°–ø—Ä–∞–≤–∫–∞ |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤
./docker-scripts.sh start

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ user-–±–æ—Ç–∞
./docker-scripts.sh logs user-bot

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞–¥–º–∏–Ω-–±–æ—Ç–∞
./docker-scripts.sh logs admin-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
./docker-scripts.sh health

# –î–æ—Å—Ç—É–ø –∫ shell –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
./docker-scripts.sh shell user-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./docker-scripts.sh stop
```

```powershell
# Windows PowerShell —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã
.\docker-scripts.ps1 start
.\docker-scripts.ps1 logs admin-bot
.\docker-scripts.ps1 health
```

### –ü—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã Docker Compose

```bash
# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ docker compose
docker compose up -d
docker compose down
docker compose logs -f
docker compose ps
docker compose build
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **Non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**
   - –ë–æ—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `botuser` (UID 1000)
   - –ù–µ—Ç root-–¥–æ—Å—Ç—É–ø–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

2. **–ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ç–∏**
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–µ—Ç–∏ `bot-network`
   - –ù–µ—Ç –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–æ–≤ –Ω–∞—Ä—É–∂—É

3. **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `python:3.12-slim-bookworm`
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø–∞–∫–µ—Ç–æ–≤

4. **–ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–∞—è —Å–±–æ—Ä–∫–∞**
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —ç—Ç–∞–ø–µ
   - –§–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å–±–æ—Ä–∫–∏

5. **–ó–∞—â–∏—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - `.env` –≤ `.dockerignore`
   - –¢–æ–∫–µ–Ω—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ–±—Ä–∞–∑

6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (10MB √ó 3 —Ñ–∞–π–ª–∞)
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```bash
# 1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π SECRET_KEY
openssl rand -hex 32

# 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .env —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
chmod 600 .env

# 3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–∑—ã
docker compose pull
docker compose up -d

# 4. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏
./docker-scripts.sh logs
```

### Firewall –ø—Ä–∞–≤–∏–ª–∞ (Ubuntu)

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞
sudo ufw default deny outgoing
sudo ufw allow out to any port 443  # Telegram API
sudo ufw allow out to any port 80   # Telegram API
sudo ufw enable
```

---

## üèóÔ∏è –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±–æ—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | User Bot | Admin Bot |
|----------------|----------|-----------|
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä** | `vpn-user-bot` | `vpn-admin-bot` |
| **Dockerfile** | `Dockerfile` | `Dockerfile.admin` |
| **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ** | –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **–¢–æ–∫–µ–Ω** | `BOT_TOKEN` | `ADMIN_BOT_TOKEN` |
| **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** | –û–±—â–∞—è (read/write) | –û–±—â–∞—è (read/write) |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–ò–∑–æ–ª—è—Ü–∏—è –æ—Ç–∫–∞–∑–æ–≤**: –ü–∞–¥–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–æ—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–æ–π
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –†–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã, —Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∞
- **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ user-–±–æ—Ç–∞
docker compose up -d user-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ admin-–±–æ—Ç–∞
docker compose up -d admin-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å admin-–±–æ—Ç–∞
docker compose restart admin-bot

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ user-–±–æ—Ç–∞
docker compose logs -f user-bot
```

---

## ‚úÖ Production Checklist

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ `.env.docker.example` –≤ `.env`
- [ ] –ó–∞–ø–æ–ª–Ω–∏–ª–∏ `BOT_TOKEN` –∏ `ADMIN_BOT_TOKEN`
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏ `SECRET_KEY` (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
- [ ] –£–∫–∞–∑–∞–ª–∏ `ADMIN_TELEGRAM_IDS`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ `LOG_LEVEL=WARNING` –∏–ª–∏ `ERROR` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –ø—Ä–∞–≤–∞ –Ω–∞ `.env` (chmod 600)

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —Å—Ç–∞—Ç—É—Å: `./docker-scripts.sh status`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ: `./docker-scripts.sh health`
- [ ] –î–æ–±–∞–≤–∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ `add_admin.py`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

### –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

- [ ] –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
- [ ] –ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ volume `bot-data`
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# Ubuntu/Linux
docker run --rm \
  -v vpn-bot-data:/data \
  -v $(pwd)/backup:/backup \
  alpine tar czf /backup/bot-db-backup.tar.gz /data

# Windows PowerShell
docker run --rm `
  -v vpn-bot-data:/data `
  -v ${PWD}/backup:/backup `
  alpine tar czf /backup/bot-db-backup.tar.gz /data
```

---

## üîß Troubleshooting

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
./docker-scripts.sh logs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
./docker-scripts.sh status

# –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—ã
./docker-scripts.sh build
./docker-scripts.sh start
```

### –û—à–∏–±–∫–∞ "BOT_TOKEN not found"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ `.env` —Ñ–∞–π–ª–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `BOT_TOKEN` –∑–∞–ø–æ–ª–Ω–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç: –±–µ–∑ –∫–∞–≤—ã—á–µ–∫ –∏ –ø—Ä–æ–±–µ–ª–æ–≤

```env
# –ü—Ä–∞–≤–∏–ª—å–Ω–æ
BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11

# –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
BOT_TOKEN = "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
```

### –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ volume
docker volume rm vpn-bot-data
./docker-scripts.sh init-db
./docker-scripts.sh start
```

### –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ Windows

```powershell
# –í–∫–ª—é—á–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
```

### –°–±—Ä–æ—Å –∫ —á–∏—Å—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é

```bash
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
./docker-scripts.sh clean

# –£–¥–∞–ª–µ–Ω–∏–µ volumes –≤—Ä—É—á–Ω—É—é
docker volume rm vpn-bot-data vpn-bot-logs vpn-admin-logs

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞
./docker-scripts.sh build
./docker-scripts.sh start
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
# –í—Å–µ –ª–æ–≥–∏
./docker-scripts.sh logs

# –¢–æ–ª—å–∫–æ user-–±–æ—Ç
./docker-scripts.sh logs user-bot

# –¢–æ–ª—å–∫–æ admin-–±–æ—Ç
./docker-scripts.sh logs admin-bot

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker compose logs --tail=100
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```bash
./docker-scripts.sh health
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
docker stats vpn-user-bot vpn-admin-bot
```

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ —Ç–æ–π –∂–µ –ª–∏—Ü–µ–Ω–∑–∏–µ–π, —á—Ç–æ –∏ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç.
